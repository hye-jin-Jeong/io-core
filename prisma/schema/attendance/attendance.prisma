// ============================================================================
// ATTENDANCE RELATED MODELS
// ============================================================================

model AttendanceRecord {
  id         String           @id @default(cuid())
  userId     String @map("user_id")
  facilityId String @map("facility_id")
  deviceId   String @map("device_id")
  tagId      String @map("tag_id")
  status     AttendanceStatus
  recordedAt DateTime         @default(now()) @map("recorded_at")
  isManual   Boolean          @default(false) @map("is_manual") // 수동 등록 여부
  note       String? // 수정 사유 등
  createdAt  DateTime         @default(now()) @map("created_at")
  updatedAt  DateTime         @updatedAt @map("updated_at")

  // Relations
  user     User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  facility Facility @relation(fields: [facilityId], references: [id], onDelete: Cascade)
  device   Device   @relation(fields: [deviceId], references: [id], onDelete: Cascade)
  tag      Tag      @relation(fields: [tagId], references: [id], onDelete: Cascade)

  // 성능 최적화를 위한 인덱스
  @@index([userId, recordedAt])
  @@index([facilityId, recordedAt])
  @@index([recordedAt])
  @@map("attendance_records")
}